--
-- PostgreSQL database dump
--

\restrict TXXips8RKM53nKxU7PdIaek9n92CQjl4bty9CZ77MMIbhDiMHGbdXeeRxjlSF41

-- Dumped from database version 16.10 (Ubuntu 16.10-0ubuntu0.24.04.1)
-- Dumped by pg_dump version 16.10 (Ubuntu 16.10-0ubuntu0.24.04.1)

SET statement_timeout = 0;
SET lock_timeout = 0;
SET idle_in_transaction_session_timeout = 0;
SET client_encoding = 'UTF8';
SET standard_conforming_strings = on;
SELECT pg_catalog.set_config('search_path', '', false);
SET check_function_bodies = false;
SET xmloption = content;
SET client_min_messages = warning;
SET row_security = off;

SET default_tablespace = '';

SET default_table_access_method = heap;

--
-- Name: cardates; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.cardates (
    id integer NOT NULL,
    carid character varying(5),
    legid integer,
    remcap integer,
    accomtype character varying(1),
    CONSTRAINT remcap_nonnegative CHECK ((remcap >= 0))
);


ALTER TABLE public.cardates OWNER TO postgres;

--
-- Name: cardates_id_seq1; Type: SEQUENCE; Schema: public; Owner: postgres
--

CREATE SEQUENCE public.cardates_id_seq1
    AS integer
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER SEQUENCE public.cardates_id_seq1 OWNER TO postgres;

--
-- Name: cardates_id_seq1; Type: SEQUENCE OWNED BY; Schema: public; Owner: postgres
--

ALTER SEQUENCE public.cardates_id_seq1 OWNED BY public.cardates.id;


--
-- Name: legs; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.legs (
    trainid character varying(3),
    dayoftrain integer,
    id integer NOT NULL,
    edgeid integer,
    date integer,
    closed boolean
);


ALTER TABLE public.legs OWNER TO postgres;

--
-- Name: cardatetrain; Type: VIEW; Schema: public; Owner: postgres
--

CREATE VIEW public.cardatetrain AS
 SELECT c.id,
    c.carid,
    c.remcap,
    c.legid,
    c.accomtype,
    l.trainid,
    l.closed
   FROM (public.cardates c
     JOIN public.legs l ON ((c.legid = l.id)));


ALTER VIEW public.cardatetrain OWNER TO postgres;

--
-- Name: citiesmain; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.citiesmain (
    index integer,
    mnemonic character varying(3) NOT NULL,
    commonname character varying(255)
);


ALTER TABLE public.citiesmain OWNER TO postgres;

--
-- Name: edges; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.edges (
    id integer NOT NULL,
    startcity character varying(3),
    endcity character varying(3)
);


ALTER TABLE public.edges OWNER TO postgres;

--
-- Name: edgeindex; Type: VIEW; Schema: public; Owner: postgres
--

CREATE VIEW public.edgeindex AS
 SELECT e.id AS edgeid,
    e.startcity,
    e.endcity,
    cs.index AS startindex,
    ce.index AS endindex
   FROM ((public.edges e
     JOIN public.citiesmain cs ON (((e.startcity)::text = (cs.mnemonic)::text)))
     JOIN public.citiesmain ce ON (((e.endcity)::text = (ce.mnemonic)::text)));


ALTER VIEW public.edgeindex OWNER TO postgres;

--
-- Name: edges_id_seq; Type: SEQUENCE; Schema: public; Owner: postgres
--

CREATE SEQUENCE public.edges_id_seq
    AS integer
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER SEQUENCE public.edges_id_seq OWNER TO postgres;

--
-- Name: edges_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: postgres
--

ALTER SEQUENCE public.edges_id_seq OWNED BY public.edges.id;


--
-- Name: legcars; Type: VIEW; Schema: public; Owner: postgres
--

CREATE VIEW public.legcars AS
 SELECT l.id AS legid,
    l.trainid,
    e.startcity,
    e.endcity,
    l.date,
    l.dayoftrain
   FROM (public.legs l
     LEFT JOIN public.edges e ON ((l.edgeid = e.id)));


ALTER VIEW public.legcars OWNER TO postgres;

--
-- Name: legedgeindex; Type: VIEW; Schema: public; Owner: postgres
--

CREATE VIEW public.legedgeindex AS
 SELECT l.trainid,
    l.dayoftrain,
    l.id AS legid,
    l.edgeid,
    l.date,
    l.closed,
    e.startcity,
    e.endcity,
    e.startindex,
    e.endindex
   FROM (public.legs l
     JOIN ( SELECT e_1.id AS edgeid,
            e_1.startcity,
            e_1.endcity,
            cs.index AS startindex,
            ce.index AS endindex
           FROM ((public.edges e_1
             JOIN public.citiesmain cs ON (((e_1.startcity)::text = (cs.mnemonic)::text)))
             JOIN public.citiesmain ce ON (((e_1.endcity)::text = (ce.mnemonic)::text)))) e ON ((l.edgeid = e.edgeid)));


ALTER VIEW public.legedgeindex OWNER TO postgres;

--
-- Name: legs_id_seq; Type: SEQUENCE; Schema: public; Owner: postgres
--

ALTER TABLE public.legs ALTER COLUMN id ADD GENERATED BY DEFAULT AS IDENTITY (
    SEQUENCE NAME public.legs_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1
);


--
-- Name: linktrains; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.linktrains (
    mainid character varying(3),
    secondid character varying(3),
    date integer
);


ALTER TABLE public.linktrains OWNER TO postgres;

--
-- Name: trainedges; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.trainedges (
    trainid character varying(3) NOT NULL,
    edgeid integer NOT NULL
);


ALTER TABLE public.trainedges OWNER TO postgres;

--
-- Name: trainedgesindex; Type: VIEW; Schema: public; Owner: postgres
--

CREATE VIEW public.trainedgesindex AS
 SELECT t.trainid,
    t.edgeid,
    e.startindex,
    e.endindex
   FROM (public.trainedges t
     LEFT JOIN public.edgeindex e ON ((t.edgeid = e.edgeid)));


ALTER VIEW public.trainedgesindex OWNER TO postgres;

--
-- Name: trains; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.trains (
    id character varying(3) NOT NULL,
    name character varying(255),
    westbound boolean
);


ALTER TABLE public.trains OWNER TO postgres;

--
-- Name: cardates id; Type: DEFAULT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.cardates ALTER COLUMN id SET DEFAULT nextval('public.cardates_id_seq1'::regclass);


--
-- Name: edges id; Type: DEFAULT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.edges ALTER COLUMN id SET DEFAULT nextval('public.edges_id_seq'::regclass);


--
-- Data for Name: cardates; Type: TABLE DATA; Schema: public; Owner: postgres
--

COPY public.cardates (id, carid, legid, remcap, accomtype) FROM stdin;
1	02501	1	76	Z
2	02501	2	76	Z
3	02501	3	72	Z
4	02501	4	72	Z
5	02502	3	68	Z
6	02502	4	68	Z
7	02503	3	76	Z
8	02503	4	76	Z
9	02504	3	39	Y
10	02504	4	39	Y
11	02601	5	68	Z
12	02602	5	72	Z
13	02603	5	76	Z
14	02604	5	39	Y
15	06417	6	76	Z
16	06416	6	76	Z
17	06415	6	76	Z
18	06414	6	76	Z
19	06413	6	66	Z
20	06412	6	40	Z
21	06411	6	76	Z
22	06410	6	76	Z
23	06405	6	45	Y
24	06404	6	45	Y
25	06403	6	45	Y
26	06402	6	45	Y
27	06517	7	76	Z
28	06516	7	76	Z
29	06515	7	76	Z
30	06514	7	76	Z
31	06513	7	66	Z
32	06512	7	40	Z
33	06511	7	76	Z
34	06510	7	76	Z
35	06505	7	45	Y
36	06504	7	45	Y
37	06503	7	45	Y
38	06502	7	45	Y
\.


--
-- Data for Name: citiesmain; Type: TABLE DATA; Schema: public; Owner: postgres
--

COPY public.citiesmain (index, mnemonic, commonname) FROM stdin;
30	AMH	Amherst
230	ARM	Armstrong
400	BBA	Boston Bar
320	BIG	Biggar
147	BKL	Brockville
380	BLR	Blue River
60	BST	Bathurst
155	BVL	Belleville
0	CGY	Calgary
255	CHG	Chicago
410	CHK	Chilliwack
165	COB	Cobourg
200	CPL	Capreol
70	CTN	Campbellton
145	CWL	Cornwall
120	DML	Drummondville
340	EDM	Edmonton
350	EDS	Edson
75	GSP	Gaspe
0	HAM	Hamilton
10	HFX	Halifax
360	HIN	Hinton
210	HPN	Horneypayne
370	JAS	Jasper
390	KAM	Kamloops
150	KGN	Kingston
0	KIT	Kitchener
235	LDN	London
100	LEV	Levis
220	LLC	Longlac
40	MCT	Moncton
80	MJO	Mont Joli
250	MKI	Minaki
140	MTL	Montreal
290	MVL	Melville
190	NBY	North Bay
50	NCL	Newcastle
0	NWR	New Westminster
160	OTT	Ottawa
170	PEM	Pembroke
0	PGO	Prince George
270	PLP	Portage La Prarie
0	PRR	Prince Rupert
180	PSO	Parry Sound
110	QBC	Quebec
90	RDL	Riviere Du Loup
0	REG	Regina
280	RIV	Rivers
245	SAR	Sarnia
310	SAS	Saskatoon
0	SFY	Ste Foy
130	SHY	St Hyacinthe
0	SJN	St Johns (NFLD)
240	SLK	Sioux Lookout
0	STC	St Catherines
1	SYD	Sydney
175	TOR	Toronto
20	TRU	Truro
420	VAN	Vancouver
60	VIC	Victoria
330	WAI	Wainwright
300	WAT	Watrous
244	WDR	Windsor
260	WPG	Winnipeg
\.


--
-- Data for Name: edges; Type: TABLE DATA; Schema: public; Owner: postgres
--

COPY public.edges (id, startcity, endcity) FROM stdin;
1	QBC	DML
2	DML	QBC
3	DML	MTL
4	MTL	DML
5	QBC	MTL
6	MTL	QBC
7	MTL	OTT
8	OTT	MTL
9	TOR	MTL
10	MTL	TOR
11	TOR	COB
12	COB	BVL
13	BVL	OTT
14	BVL	KGN
15	KGN	BKL
16	BKL	CWL
17	CWL	MTL
18	COB	TOR
19	BVL	COB
20	OTT	BVL
21	KGN	BVL
22	BKL	KGN
23	CWL	BKL
24	MTL	CWL
\.


--
-- Data for Name: legs; Type: TABLE DATA; Schema: public; Owner: postgres
--

COPY public.legs (trainid, dayoftrain, id, edgeid, date, closed) FROM stdin;
025	0	1	1	1	f
025	0	2	3	1	f
025	0	3	1	2	f
025	0	4	3	2	f
026	0	5	6	2	f
064	0	6	9	2	f
065	0	7	10	2	f
\.


--
-- Data for Name: linktrains; Type: TABLE DATA; Schema: public; Owner: postgres
--

COPY public.linktrains (mainid, secondid, date) FROM stdin;
\.


--
-- Data for Name: trainedges; Type: TABLE DATA; Schema: public; Owner: postgres
--

COPY public.trainedges (trainid, edgeid) FROM stdin;
022	4
022	2
025	1
025	3
028	4
028	2
029	1
029	3
023	5
024	6
026	6
027	5
030	8
031	7
034	8
035	7
036	8
038	8
039	7
064	9
065	10
\.


--
-- Data for Name: trains; Type: TABLE DATA; Schema: public; Owner: postgres
--

COPY public.trains (id, name, westbound) FROM stdin;
022	\N	f
025	\N	t
028	\N	f
029	\N	t
023	\N	t
024	\N	f
026	\N	f
027	\N	t
030	\N	f
031	\N	t
034	\N	f
035	\N	t
036	\N	f
038	\N	f
039	\N	t
064	\N	f
065	\N	t
050	\N	f
051	\N	t
054	\N	f
055	\N	t
\.


--
-- Name: cardates_id_seq1; Type: SEQUENCE SET; Schema: public; Owner: postgres
--

SELECT pg_catalog.setval('public.cardates_id_seq1', 38, true);


--
-- Name: edges_id_seq; Type: SEQUENCE SET; Schema: public; Owner: postgres
--

SELECT pg_catalog.setval('public.edges_id_seq', 24, true);


--
-- Name: legs_id_seq; Type: SEQUENCE SET; Schema: public; Owner: postgres
--

SELECT pg_catalog.setval('public.legs_id_seq', 7, true);


--
-- Name: cardates cardates_pkey1; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.cardates
    ADD CONSTRAINT cardates_pkey1 PRIMARY KEY (id);


--
-- Name: citiesmain citiesmain_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.citiesmain
    ADD CONSTRAINT citiesmain_pkey PRIMARY KEY (mnemonic);


--
-- Name: edges edges_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.edges
    ADD CONSTRAINT edges_pkey PRIMARY KEY (id);


--
-- Name: cardates nodupe_cardates; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.cardates
    ADD CONSTRAINT nodupe_cardates UNIQUE (legid, carid);


--
-- Name: legs pk_id; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.legs
    ADD CONSTRAINT pk_id PRIMARY KEY (id);


--
-- Name: trainedges trainedges_pk; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.trainedges
    ADD CONSTRAINT trainedges_pk PRIMARY KEY (trainid, edgeid);


--
-- Name: trains trains_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.trains
    ADD CONSTRAINT trains_pkey PRIMARY KEY (id);


--
-- Name: cardates cardates_legid_fkey1; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.cardates
    ADD CONSTRAINT cardates_legid_fkey1 FOREIGN KEY (legid) REFERENCES public.legs(id);


--
-- Name: edges edges_endcity_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.edges
    ADD CONSTRAINT edges_endcity_fkey FOREIGN KEY (endcity) REFERENCES public.citiesmain(mnemonic);


--
-- Name: edges edges_start_city_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.edges
    ADD CONSTRAINT edges_start_city_fkey FOREIGN KEY (startcity) REFERENCES public.citiesmain(mnemonic);


--
-- Name: legs legs_edgeid_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.legs
    ADD CONSTRAINT legs_edgeid_fkey FOREIGN KEY (edgeid) REFERENCES public.edges(id);


--
-- Name: legs legs_trainid_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.legs
    ADD CONSTRAINT legs_trainid_fkey FOREIGN KEY (trainid) REFERENCES public.trains(id);


--
-- Name: linktrains linktrains_mainid_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.linktrains
    ADD CONSTRAINT linktrains_mainid_fkey FOREIGN KEY (mainid) REFERENCES public.trains(id);


--
-- Name: linktrains linktrains_secondid_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.linktrains
    ADD CONSTRAINT linktrains_secondid_fkey FOREIGN KEY (secondid) REFERENCES public.trains(id);


--
-- Name: trainedges trainedges_edgeid_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.trainedges
    ADD CONSTRAINT trainedges_edgeid_fkey FOREIGN KEY (edgeid) REFERENCES public.edges(id);


--
-- Name: trainedges trainedges_trainid_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.trainedges
    ADD CONSTRAINT trainedges_trainid_fkey FOREIGN KEY (trainid) REFERENCES public.trains(id);


--
-- Name: SCHEMA public; Type: ACL; Schema: -; Owner: pg_database_owner
--

GRANT ALL ON SCHEMA public TO collins;


--
-- Name: TABLE cardates; Type: ACL; Schema: public; Owner: postgres
--

GRANT ALL ON TABLE public.cardates TO collins;


--
-- Name: SEQUENCE cardates_id_seq1; Type: ACL; Schema: public; Owner: postgres
--

GRANT ALL ON SEQUENCE public.cardates_id_seq1 TO collins;


--
-- Name: TABLE legs; Type: ACL; Schema: public; Owner: postgres
--

GRANT ALL ON TABLE public.legs TO collins;


--
-- Name: TABLE cardatetrain; Type: ACL; Schema: public; Owner: postgres
--

GRANT ALL ON TABLE public.cardatetrain TO collins;


--
-- Name: TABLE citiesmain; Type: ACL; Schema: public; Owner: postgres
--

GRANT ALL ON TABLE public.citiesmain TO collins;


--
-- Name: TABLE edges; Type: ACL; Schema: public; Owner: postgres
--

GRANT ALL ON TABLE public.edges TO collins;


--
-- Name: TABLE edgeindex; Type: ACL; Schema: public; Owner: postgres
--

GRANT ALL ON TABLE public.edgeindex TO collins;


--
-- Name: SEQUENCE edges_id_seq; Type: ACL; Schema: public; Owner: postgres
--

GRANT ALL ON SEQUENCE public.edges_id_seq TO collins;


--
-- Name: TABLE legcars; Type: ACL; Schema: public; Owner: postgres
--

GRANT ALL ON TABLE public.legcars TO collins;


--
-- Name: TABLE legedgeindex; Type: ACL; Schema: public; Owner: postgres
--

GRANT ALL ON TABLE public.legedgeindex TO collins;


--
-- Name: SEQUENCE legs_id_seq; Type: ACL; Schema: public; Owner: postgres
--

GRANT ALL ON SEQUENCE public.legs_id_seq TO collins;


--
-- Name: TABLE linktrains; Type: ACL; Schema: public; Owner: postgres
--

GRANT ALL ON TABLE public.linktrains TO collins;


--
-- Name: TABLE trainedges; Type: ACL; Schema: public; Owner: postgres
--

GRANT ALL ON TABLE public.trainedges TO collins;


--
-- Name: TABLE trainedgesindex; Type: ACL; Schema: public; Owner: postgres
--

GRANT ALL ON TABLE public.trainedgesindex TO collins;


--
-- Name: TABLE trains; Type: ACL; Schema: public; Owner: postgres
--

GRANT ALL ON TABLE public.trains TO collins;


--
-- Name: DEFAULT PRIVILEGES FOR TABLES; Type: DEFAULT ACL; Schema: public; Owner: postgres
--

ALTER DEFAULT PRIVILEGES FOR ROLE postgres IN SCHEMA public GRANT ALL ON TABLES TO collins;


--
-- PostgreSQL database dump complete
--

\unrestrict TXXips8RKM53nKxU7PdIaek9n92CQjl4bty9CZ77MMIbhDiMHGbdXeeRxjlSF41

